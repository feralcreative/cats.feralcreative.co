/**
 * MIXINS
 * 
 * Reusable mixins for common patterns and responsive design.
 * Using modern Sass module system with @use.
 */

@use "sass:map";
@use "variables" as *;

// =============================================================================
// RESPONSIVE BREAKPOINTS
// =============================================================================

/// Responsive breakpoint mixin
/// @param {String} $breakpoint - Breakpoint name from $breakpoints map
/// @param {String} $direction - 'up' for min-width, 'down' for max-width
@mixin breakpoint($breakpoint, $direction: up) {
  @if map.has-key($breakpoints, $breakpoint) {
    $breakpoint-value: map.get($breakpoints, $breakpoint);

    @if $direction == up {
      @media (min-width: $breakpoint-value) {
        @content;
      }
    } @else if $direction == down {
      @media (max-width: $breakpoint-value - 1px) {
        @content;
      }
    }
  } @else {
    @warn "Invalid breakpoint: #{$breakpoint}. Available breakpoints: #{map.keys($breakpoints)}";
  }
}

/// Mobile-first responsive mixin shortcuts
@mixin mobile-up {
  @include breakpoint(sm) {
    @content;
  }
}

@mixin tablet-up {
  @include breakpoint(md) {
    @content;
  }
}

@mixin desktop-up {
  @include breakpoint(lg) {
    @content;
  }
}

@mixin large-up {
  @include breakpoint(xl) {
    @content;
  }
}

// =============================================================================
// LAYOUT MIXINS
// =============================================================================

/// Container mixin with max-width and padding
@mixin container($max-width: $container-max-width, $padding: $container-padding) {
  max-width: $max-width;
  margin: 0 auto;
  padding-left: $padding;
  padding-right: $padding;
}

/// Flexbox center alignment
@mixin flex-center {
  display: flex;
  align-items: center;
  justify-content: center;
}

/// Flexbox space between
@mixin flex-between {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

/// Grid layout mixin
@mixin grid($columns: $grid-columns, $gap: $grid-gutter) {
  display: grid;
  grid-template-columns: repeat($columns, 1fr);
  gap: $gap;
}

/// Aspect ratio mixin
@mixin aspect-ratio($width: 16, $height: 9) {
  aspect-ratio: #{$width} / #{$height};

  // Fallback for older browsers
  @supports not (aspect-ratio: 1) {
    position: relative;

    &::before {
      content: "";
      display: block;
      padding-top: percentage($height / $width);
    }

    > * {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  }
}

// =============================================================================
// TYPOGRAPHY MIXINS
// =============================================================================

/// Font size with responsive scaling
@mixin font-size($size, $line-height: null) {
  font-size: $size;

  @if $line-height {
    line-height: $line-height;
  }

  // Responsive scaling for larger screens
  @include breakpoint(lg) {
    font-size: $size * 1.1;
  }
}

/// Truncate text with ellipsis
@mixin text-truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/// Multi-line text truncation
@mixin text-truncate-lines($lines: 2) {
  display: -webkit-box;
  -webkit-line-clamp: $lines;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

// =============================================================================
// VISUAL EFFECTS MIXINS
// =============================================================================

/// Box shadow with multiple levels
@mixin shadow($level: 1) {
  @if $level == 1 {
    box-shadow: $shadow-sm;
  } @else if $level == 2 {
    box-shadow: $shadow;
  } @else if $level == 3 {
    box-shadow: $shadow-md;
  } @else if $level == 4 {
    box-shadow: $shadow-lg;
  } @else if $level == 5 {
    box-shadow: $shadow-xl;
  }
}

/// Transition mixin with customizable properties
@mixin transition($properties: all, $duration: $transition-duration-base, $timing: $transition-timing-function) {
  transition: $properties $duration $timing;
}

/// Hover state with transition
@mixin hover-transition($property: all, $duration: $transition-duration-fast) {
  transition: $property $duration $transition-timing-function;

  &:hover {
    @content;
  }
}

// =============================================================================
// ACCESSIBILITY MIXINS
// =============================================================================

/// Screen reader only content
@mixin sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/// Focus styles for accessibility
@mixin focus-outline($color: $color-primary, $width: 2px, $offset: 2px) {
  &:focus {
    outline: $width solid $color;
    outline-offset: $offset;
  }

  &:focus:not(:focus-visible) {
    outline: none;
  }
}

/// Reduced motion support
@mixin reduced-motion {
  @media (prefers-reduced-motion: reduce) {
    @content;
  }
}

// =============================================================================
// UTILITY MIXINS
// =============================================================================

/// Clear floats
@mixin clearfix {
  &::after {
    content: "";
    display: table;
    clear: both;
  }
}

/// Hide element visually but keep accessible
@mixin visually-hidden {
  @include sr-only;
}

/// Reset list styles
@mixin list-reset {
  list-style: none;
  padding: 0;
  margin: 0;
}
